/*-------------------Common Functions----------------------*/

/*Allow only numeric value*/
$(".numeric").keydown(function (e) {
	// Allow: backspace, delete, tab, escape, enter and .
	if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110]) !== -1 ||
		// Allow: Ctrl+A, Command+A
		(e.keyCode === 65 && (e.ctrlKey === true || e.metaKey === true)) ||
		// Allow: home, end, left, right, down, up
		(e.keyCode >= 35 && e.keyCode <= 40)) {
		// let it happen, don't do anything
		return;
	}
	// Ensure that it is a number and stop the keypress
	if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
		e.preventDefault();
	}
});

function ValidateNumber(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode;
    if ((charCode < 48 || charCode > 57))
        return false;

    return true;
}
/*Allow only numeric value*/

/*Allow only 6 digit pincode*/
 $('.pincode').on("keypress",function(e) {
   var foo = $(this).val();
   if (foo.length >= 6) { 
     return false;
   }
   return true;
});

function limit(event, count) {
	var _data = event.target.value;
    if (_data.length < count)  
    {     
           return true;    
    }
    else
    {
        return false;
    }
}

/*Allow only 6 digit pincode*/

/*Function to validate Email*/
	function ValidateEmail(email) {
	  var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
	  return regex.test(email);
	}
/*Function to validate Email*/


// ========================== Allow - Only Letters ========================================================//
function ValidateAlphabets(key) {
    var keycode = (key.which) ? key.which : key.keyCode;

    if ((keycode > 64 && keycode < 91) || (keycode > 96 && keycode < 123) || keycode == 32)  
    {     
           return true;    
    }
    else
    {
        return false;
    }
}
//============================ Common Functions ============================================================//

//============================ Remove Error class on change ============================================================//
	$(function(){
		$(document).on("change",function(){
			$(".error").removeClass("error");
		});		
	});

//============================ Remove Error class on change ============================================================//

//============================ banner form ============================================================//


$(function(){
	var _customerName = $('#_customerName');
	var _customerEmail = $("#_customerEmail");
	var _customerPhone = $("#_customerPhone");
	var _customerType = $('#_customerType');
	var _PolicyNumber = $('#_PolicyNumber');
	var _customerPincode = $('#_customerPincode');
	
	function ResetBannerForm(){
		
		_customerName.attr("placeholder","Enter your Name");
		_customerEmail.attr("placeholder","Enter your Email ID");
		_customerPhone.attr("placeholder","Enter your Phone");
		_customerType.attr("placeholder","Please select Company Type");
		_PolicyNumber.attr("placeholder","Enter your Policy Number");
		_customerPincode.attr("placeholder","Enter your Pin Code");
		
		_customerName.val('');
		_customerEmail.val('');
		_customerPhone.val('');
		_customerType.val('');
		_PolicyNumber.val('');
		_customerPincode.val('');
		
	}
	
	function clearFormSummary(){
	$(".form-summary").hide();
		$(".custom-form").show();
	}

	function ShowFormSummary(){
		$(".form-summary").show();
		$(".custom-form").hide();
	} 
	
		
	$(document).ready(function(){
		clearFormSummary();
		
	});
	
	$('input').focus(function () {
		$(this).closest(".fieldWrapper").removeClass("error");
		$(this).closest(".smGap").find(".err").hide();
	});
	
	$('#_callAdvisor').click(function () {
				
		if (_customerName.val() == "") {
			_customerName.attr("placeholder", "Please enter your name");
			_customerName.closest(".fieldWrapper").addClass("error");
			return false;
		}

		if (_customerEmail.val() == "") {
			_customerEmail.attr("placeholder", "Please enter your email");

			_customerEmail.closest(".fieldWrapper").addClass("error");
			//_customerEmail.closest(".fieldWrapper").find(".err").text("Please enter your Email");

			return false;
		}
		else {
			if(!ValidateEmail(_customerEmail.val()))
			   {
				_customerEmail.attr("placeholder", "Please enter correct email");

				 _customerEmail.closest(".fieldWrapper").addClass("error");
				 _customerEmail.closest(".fieldWrapper").find(".err").text("Please enter Correct Email");
			   return false;
			   }
			_customerEmail.attr("placeholder", "Email");
		}
		if (_customerPhone.val() == "") {
			_customerPhone.attr("placeholder", "Please enter correct email");

			_customerPhone.closest(".fieldWrapper").addClass("error");
			return false;
		}
		

		if (_customerType.val() == "") {
			_customerType.attr("placeholder", "Please enter correct email");
			_customerType.closest(".fieldWrapper").addClass("error");
			return false;
		}
		
		if(_customerPincode.val() != "")
		{
			if (_customerPincode.val().length != 6) {
				_customerPincode.attr("placeholder", "Please enter correct pincode.");
				_customerPincode.closest(".fieldWrapper").addClass("error");
				return false;
			}
		}

		var model = {
			Name: _customerName.val(),
			Email: _customerEmail.val(),
			Mobile: _customerPhone.val(),
			CustomerType:_customerType.val(),
			PolicyNumber:_PolicyNumber.val(),
			Pincode:_customerPincode.val(),
			utm_source:"Home Page"
		};
		
	   var settings = {
			"async": true,
			"url": "/Umbraco/Surface/CallLog/GetCallBack",
			"method": "POST",
			contentType: "application/json; charset=utf-8",
			"data": JSON.stringify(model)
		}

		$.ajax(settings).done(function (response) {
			window.location.href = "https://life.futuregenerali.in/thankyou/";

			ShowFormSummary();
			ResetBannerForm();
			
		});
	});
	
	$("#flexCheckChecked").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false)
		{
			$("#_callAdvisor").attr("disabled","disabled");
		}
		else{
			$("#_callAdvisor").removeAttr("disabled");
		}
	});
	
});

//============================ banner form ============================================================//


//============================ sidebar form ============================================================//
        $(document).ready(function () {
            $('#btnSideBar_Submit').click(function () {
                if ($('#callBackSideBar_Name').val() == "") {
                    $('#callBackSideBar_Name').addClass("error");
                    $('#callBackSideBar_Name').focus();
                    alert("Name is required!");
                    return false;
                }
                else {
                    $('#callBackSideBar_Name').removeClass("error");
                }
                if ($('#callBackSideBar_Email').val() == "") {
                    $('#callBackSideBar_Email').addClass("error");
                    alert("Email is required!");

                    $('#callBackSideBar_Email').focus();
                    return false;
                }
                else {
                    if(!ValidateEmail($('#callBackSideBar_Email').val()))
                       {
                        $('#callBackSideBar_Email').addClass("error");
                        alert("Incorrect email address!");

                       return false;
                       }
                    $('#callBackSideBar_Email').removeClass("error");
                }
                if ($('#callBackSideBar_Phone').val() == "") {
                    $('#callBackSideBar_Phone').addClass("error");
                    alert("Phone number is required!");

                    $('#callBackSideBar_Phone').focus();
                    return false;
                }
                else {
                    $('#callBackSideBar_Phone').removeClass("error");
                }
                if ($('#callBackSideBar_Pincode').val() == "") {
                    $('#callBackSideBar_Pincode').addClass("error");
                    alert("Pincode is required.");
                    $('#callBackSideBar_Pincode').focus();
                    return false;
                }
                else {
                    $('#callBackSideBar_Pincode').removeClass("error");
                }
                var model = {
                    Name: $('#callBackSideBar_Name').val(),
                    Email: $('#callBackSideBar_Email').val(),
                    Mobile: $('#callBackSideBar_Phone').val(),
                    Pincode:$('#callBackSideBar_Pincode').val(),
                };

               var settings = {
                    "async": true,
                    "url": "/Umbraco/Surface/CallLog/GetCallBack",
                    "method": "POST",
                    contentType: "application/json; charset=utf-8",
                    "data": JSON.stringify(model)
                }

                $.ajax(settings).done(function (response) {
                    console.log(response);
                    alert("Thank you one of our associate will call you back.");
                    $("#callBackSideBar_Name").val('');
                    $("#callBackSideBar_Email").val('');
                    $("#callBackSideBar_Phone").val('');
                    $('#callBackSideBar_Pincode').val('');
                });
            });
        });

//============================ sidebar form ============================================================//


//============================ art workshop  ============================================================//


$(function(){
  var childName = $('#txtChildName');
  var childAge = $('#txtChildAge');
  var fullName = $('#txtFullName');
  var email = $("#txtEmailId");
  var phoneNo = $("#txtPhoneNo");
  var city = $('#txtCity');
  var pincode = $('#txtPincode'); 



  $('#btnSubmitArtWorkShop').click(function () {
        debugger;
    if (childName.val() == "") {
      childName.closest(".smGap").find(".err").text("Please enter your children name.");
	  childName.closest(".smGap").find(".err").show();
      return false;
    }

     if (childAge.val() == "") {
       childAge.closest(".smGap").find(".err").text("Please enter your children age.");
	   childAge.closest(".smGap").find(".err").show();

      return false;
    }

     if (fullName.val() == "") {
		 fullName.closest(".smGap").find(".err").text("Please enter your name.");
	   fullName.closest(".smGap").find(".err").show();
      return false;
    }

    if (email.val() == "") {
       email.closest(".smGap").find(".err").text("Please enter your email.");
	   email.closest(".smGap").find(".err").show();
      return false;
    }
    else {
      if(!ValidateEmail(email.val()))
         {
			email.closest(".smGap").find(".err").text("Please enter correct email.");
			email.closest(".smGap").find(".err").show();
         return false;
         }
         else{
			email.closest(".smGap").find(".err").hide();
         }
    }

    if (phoneNo.val() == "") {
		phoneNo.closest(".smGap").find(".err").text("Please enter your phone number.");
		phoneNo.closest(".smGap").find(".err").show();
      return false;
    }

     if (city.val() == "") {
		 city.closest(".smGap").find(".err").text("Please enter your city.");
		 city.closest(".smGap").find(".err").show();
      return false;
    }

     if (pincode.val() == "") {
		 pincode.closest(".smGap").find(".err").text("Please enter your pincode.");
		 pincode.closest(".smGap").find(".err").show();
      return false;
    }


    var model = {
      ChildName: childName.val(),
      ChildAge: childAge.val(),
      Name: fullName.val(),
      Email: email.val(),
      Mobile: phoneNo.val(),
      city: city.val(),
      Pincode: pincode.val(),
      utm_source:"Art Workshop Registration",
      thankyou_page_url:"/art-workshop-registration/thank-you"
    };
    
     var settings1 = {
      "async": true,
      "url": "/Umbraco/Surface/CallLog/GetCallBack",
      "method" : "POST",
      contentType: "application/json; charset=utf-8",
      "data": JSON.stringify(model)
    }

    $.ajax(settings1).done(function (response) {
		window.location.href = "http://life.futuregenerali.in/art-workshop-registration/thank-you";

    });
  });
  
  $("#chkTerms").change(function(){
    var _result = $(this).prop("checked");
    
    if(_result == false)
    {
      $("#btnSubmitArtWorkShop").attr("disabled","disabled");
    }
    else{
      $("#btnSubmitArtWorkShop").removeAttr("disabled");
    }
  });
  
});

//============================ art workshop form ============================================================//

//============================= send an advisor form =======================================================//


function InitializeSendAnAdvisor(utm_source, utm_medium, utm_campaign, utm_term, utm_content, IsRedirect=false)
{
	const _source = utm_source;
	const _campaign = utm_campaign;
	const _content = utm_content;
	const _medium = utm_medium;
	const _keyword = utm_term;

	
	var form = $("#formwidAdvisor");

	var Name = form.find('#SAdvName');
	var Email = form.find("#SAdvEmail");
	var Phone = form.find("#SAdvPhoneNo");
	var Pincode = form.find('#SAdvPinCode');
	
	function ResetSendAnAdvisorForm(){
		Name.val('');
		Email.val('');
		Phone.val('');
		Pincode.val('');
	}
	
	$(document).ready(function(){
		ResetSendAnAdvisorForm();
	});
	
	$('input').focus(function () {
		$(this).closest(".fieldWrapper").removeClass("error");
		$(this).closest(".smGap").find(".err").hide();
	});
	
	$('#btnSubmitAdvisor').click(function () {
		if (Name.val() == "") {
			Name.closest(".fieldWrapper").find(".err").text("Please enter your Name");
			Name.closest(".fieldWrapper").addClass("error");
			return false;
		}
		
		
		if (Phone.val() == "") {
			Phone.closest(".fieldWrapper").find(".err").text("Please enter your Mobile No");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else if(Phone.val().length != 10){
			Phone.closest(".fieldWrapper").find(".err").text("Mobile No should be 10 digits");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}

		if (Email.val() == "") {
			Email.closest(".fieldWrapper").find(".err").text("Please enter your Email");
			Email.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else {
			if(!ValidateEmail(Email.val()))
			   {
				 Email.closest(".fieldWrapper").addClass("error");
				 Email.closest(".fieldWrapper").find(".err").text("Please enter Correct Email");
				 return false;
			   }
			Email.attr("placeholder", "Email");
		}

		
		if (Pincode.val() == "") {
			Pincode.closest(".fieldWrapper").find(".err").text("Please enter your Pincode");
			Pincode.closest(".fieldWrapper").addClass("error");
			return false;
		}
				
		
		if(_source =="")
		{
			_source = "Webpage";
		}
		
		var model = {
			AdvName: Name.val(),
			Email: Email.val(),
			AdvPhone: Phone.val(),
			AdvPincode: Pincode.val(),
			AdvSource: _source,
			AdvUtmCompaign : _campaign,
			AdvUtmContent : _content,
			AdvUtmMedium : _medium,
			AdvKeyword : _keyword,
			AdvCampaign : "Trust Campaign"
		};
		
	   var settings = {
			"async": true,
			"url": "/Umbraco/Surface/Advisor/HandleAdvisorEnquirySubmit",
			"method": "POST",
			contentType: "application/json; charset=utf-8",
			"data": JSON.stringify(model)
		}

		$.ajax(settings).done(function (response) {
			if(IsRedirect)
			{
				window.location.href = "https://life.futuregenerali.in/thankyou/";
			}
			else{
				$(".send-an-advisor-form").hide();
				$(".form-summary").show();
			}
			
		});
	});
	
	$("#SAdvCheck").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheckTerm").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

	$("#SAdvCheckTerm").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheck").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

}

//============================= send an advisor form =======================================================//


//============================= send an advisor form =======================================================//


function InitializeSendAnAdvisorWithOTP(utm_source, utm_medium, utm_campaign, utm_term, utm_content, IsRedirect=false)
{
	const _source = utm_source;
	const _campaign = utm_campaign;
	const _content = utm_content;
	const _medium = utm_medium;
	const _keyword = utm_term;
	var IsVerify = false;
	
	var form = $("#formwidAdvisor");
	var formOTP = $("#formwidAdvisorOTP");

	var Name = form.find('#SAdvName');
	var Email = form.find("#SAdvEmail");
	var Phone = form.find("#SAdvPhoneNo");
	var Pincode = form.find('#SAdvPinCode');
	var campaignName = form.find('#AdvCampaign').val();
	
	function ResetSendAnAdvisorForm(){
		Name.val('');
		Email.val('');
		Phone.val('');
		Pincode.val('');
	}
	
	$(document).ready(function(){
		ResetSendAnAdvisorForm();
	});
	
	$('input').focus(function () {
		$(this).closest(".fieldWrapper").removeClass("error");
		$(this).closest(".smGap").find(".err").hide();
	});

	$('#btnSubmitAdvisor').click(function () {
		if (Name.val() == "") {
			Name.closest(".fieldWrapper").find(".err").text("Please enter your Name");
			Name.closest(".fieldWrapper").addClass("error");
			return false;
		}
		
		
		if (Phone.val() == "") {
			Phone.closest(".fieldWrapper").find(".err").text("Please enter your Mobile Number");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else if(Phone.val().length != 10){
			Phone.closest(".fieldWrapper").find(".err").text("Mobile Number should be 10 digits");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}

		if (Email.val() == "") {
			Email.closest(".fieldWrapper").find(".err").text("Please enter your Email");
			Email.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else {
			if(!ValidateEmail(Email.val()))
			   {
				 Email.closest(".fieldWrapper").addClass("error");
				 Email.closest(".fieldWrapper").find(".err").text("Please enter Correct Email");
				 return false;
			   }
			Email.attr("placeholder", "Email");
		}

		
		if (Pincode.val() == "") {
			Pincode.closest(".fieldWrapper").find(".err").text("Please enter your Pincode");
			Pincode.closest(".fieldWrapper").addClass("error");
			return false;
		}
				
		
		if(_source =="")
		{
			_source = "Webpage";
		}
		
		var model = {
			AdvName: Name.val(),
			Email: Email.val(),
			AdvPhone: Phone.val(),
			AdvPincode: Pincode.val(),
			AdvSource: _source,
			AdvUtmCompaign : _campaign,
			AdvUtmContent : _content,
			AdvUtmMedium : _medium,
			AdvKeyword : _keyword,
			AdvCampaign : campaignName?campaignName:"OTP Verified Leads",
			page_url:$("#PageURL").val()
		};
		
		//if(IsVerify)
		//{
		   var settings = {
				"async": true,
				"url": "/Umbraco/Surface/Advisor/HandleAdvisorEnquirySubmit",
				"method": "POST",
				contentType: "application/json; charset=utf-8",
				"data": JSON.stringify(model)
			}

			$.ajax(settings).done(function (response) {
				$.ajax({
					type : "POST",
					url:"/umbraco/surface/Advisor/SendOTP",
					data:{ MobileNo : Phone.val(), Source : _source },
					success:function(data){
						if(data.code == 200)
						{					
							$("#spnPhoneNo").text(Phone.val().toString().substr(-2));
							$("#VerifyOTPModal").modal('show');
							console.log(data.message);
						}else{
							console.log(data.message);
						}
					},
					error:function(err){
						console.log(err);
					}
				});
				// if(IsRedirect)
				// {
					// window.location.href = "https://life.futuregenerali.in/thankyou/";
				// }
				// else{
					// $(".send-an-advisor-form").hide();
					// $(".form-summary").show();
				// }
			});
		//}
		//else{
			
			//InitializeCountDown();
		//}
	});
	
		function InitializeCountDown(){
			var date= new Date();
			var countDownTime = new Date(date.getTime() + 60000);
			var x = setInterval(function(){
				var now = new Date().getTime();
				var distance = countDownTime - now;
				$("#time").show();
				$("#time").text("");
				
				var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
				var seconds = Math.floor((distance % (1000 * 60)) / 1000);
				
				var _seconds ="";
				if(seconds<10){
					_seconds = "0"+ seconds.toString();
				}else{
					_seconds = seconds.toString();
				}
				
				$("#time").text("0" + minutes.toString() + ":" + _seconds);
				if (distance < 1) {
					clearInterval(x);
					$("#divAfterOneMinute").show();
					$("#time").hide();
				}
			},1000);
		}
		
		$("#btnChangeNumber").on("click",function(){
			$("#VerifyOTPModal").modal('hide');
			Phone.focus();
		});
		
		$("#btnResendOTP").on("click",function(){
			$.ajax({
				type : "POST",
				url:"/umbraco/surface/Advisor/SendOTP",
				data:{ MobileNo : Phone.val(), Source : _source },
				success:function(data){
					if(data.code == 200)
					{					
						console.log(data.message);
					}else{
						console.log(data.message);
					}
				},
				error:function(err){
					console.log(err);
				}
			});
		});
		
		$("#btnVerifyOTP").on("click",function(){
			
			if($("#txtOTP").val() == "")
			{
				$("#errOTP").text("Please enter OTP to verify your Mobile No.");
				return false;
			}
			else if($("#txtOTP").val().length != 6)
			{
				$("#errOTP").text("OTP cannot be more or less than 6 digits.");
				return false;
			}
			else{
			
				$.ajax({
					type : "POST",
					url:"/umbraco/surface/Advisor/VerifyOTP",
					data:{ MobileNo : Phone.val(), OTP : parseInt($("#txtOTP").val()) },
					success:function(data){
						if(data.code == 200)
						{			
							$("#errOTP").text('OTP Verified Successfully.');
							IsVerify = true;

							setTimeout(function(){
								//$("#btnSubmitAdvisor").trigger("click");
								window.location.href = "https://life.futuregenerali.in/thankyou/";
								$("#VerifyOTPModal").modal('hide');
							},2000);
							
							console.log(data.message);
						}else{
							$("#errOTP").text(data.message);
							console.log(data.message);
						}
					},
					error:function(err){
						console.log(err);
					}
				});
			}
		});
		
		
	
	$("#SAdvCheck").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheckTerm").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

	$("#SAdvCheckTerm").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheck").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

}

//============================= send an advisor form =======================================================//

function InitializeTrustNewLeads(campaign,utm_source, utm_medium, utm_campaign, utm_term, utm_content, IsRedirect=false)
{
	//debugger;
	var _source = utm_source;
	const _campaign = utm_campaign;
	const _content = utm_content;
	const _medium = utm_medium;
	var _keyword = utm_term;

	
	var form = $("#formwidAdvisor");

	var Name = form.find('#SAdvName');
	var Email = form.find("#SAdvEmail");
	var Phone = form.find("#SAdvPhoneNo");
	var Pincode = form.find('#SAdvPinCode');
	
	function ResetSendAnAdvisorForm(){
		Name.val('');
		Email.val('');
		Phone.val('');
		Pincode.val('');
	}
	
	$(document).ready(function(){
		ResetSendAnAdvisorForm();
	});
	
	$('input').focus(function () {
		$(this).closest(".fieldWrapper").removeClass("error");
		$(this).closest(".smGap").find(".err").hide();
	});
	
	$('#btnSubmitAdvisor').click(function () {
		if (Name.val() == "") {
			Name.closest(".fieldWrapper").find(".err").text("Please enter your Name");
			Name.closest(".fieldWrapper").addClass("error");
			return false;
		}
		
		if (Email.val() == "") {
			Email.closest(".fieldWrapper").find(".err").text("Please enter your Email");
			Email.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else {
			if(!ValidateEmail(Email.val()))
			   {
				 Email.closest(".fieldWrapper").addClass("error");
				 Email.closest(".fieldWrapper").find(".err").text("Please enter Correct Email");
				 return false;
			   }
			Email.attr("placeholder", "Email");
		}
		
		if (Phone.val() == "") {
			Phone.closest(".fieldWrapper").find(".err").text("Please enter your Mobile No");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else if(Phone.val().length != 10){
			Phone.closest(".fieldWrapper").find(".err").text("Mobile No should be 10 digits");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}

		
		if (Pincode.val() == "") {
			Pincode.closest(".fieldWrapper").find(".err").text("Please enter your Pincode");
			Pincode.closest(".fieldWrapper").addClass("error");
			return false;
		}
				
		
		if(_source =="")
		{
			_source = "Webpage";
		}
		if(_keyword == "")
		{
			_keyword = "Low Intent";
		}
		
		
		
		
		var model = {
			AdvName: Name.val(),
			Email: Email.val(),
			AdvPhone: Phone.val(),
			AdvPincode: Pincode.val(),
			AdvSource: _source,
			AdvUtmCompaign : _campaign,
			AdvUtmContent : _content,
			AdvUtmMedium : _medium,
			AdvKeyword : _keyword,
			AdvCampaign : campaign //low intent
		};
		
	   var settings = {
			"async": true,
			"url": "/Umbraco/Surface/Advisor/HandleAdvisorEnquirySubmit",
			"method": "POST",
			contentType: "application/json; charset=utf-8",
			"data": JSON.stringify(model)
		}

		$.ajax(settings).done(function (response) {
			if(IsRedirect)
			{
				window.location.href = "https://life.futuregenerali.in/thankyou/";
			}
			else{
				$(".send-an-advisor-form").hide();
				$(".form-summary").show();
			}
			
		});
	});
	
	$("#SAdvCheck").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheckTerm").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

	$("#SAdvCheckTerm").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheck").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});
}

function InitializeLTIP(utm_source, utm_medium, utm_campaign, utm_term, utm_content, IsRedirect=false)
{
	
	var jsonData;
	
	const _source = utm_source;
	const _campaign = utm_campaign;
	const _content = utm_content;
	const _medium = utm_medium;
	const _keyword = utm_term;
	var IsVerify = false;
	
	var form = $("#formwidAdvisor");
	var formOTP = $("#formwidAdvisorOTP");

	var Name = form.find('#SAdvName');
	var Email = form.find("#SAdvEmail");
	var Phone = form.find("#SAdvPhoneNo");
	var Pincode = form.find('#SAdvPinCode');
	var campaignName = form.find('#AdvCampaign').val();
	
	
	 $.getJSON("/content/pincodes.json", function (data) {
            jsonData = data; 
        }).fail(function (jqXHR, textStatus, errorThrown) {
            console.log("Error: " + errorThrown);
        });
	
	function ResetSendAnAdvisorForm(){
		Name.val('');
		Email.val('');
		Phone.val('');
		Pincode.val('');
	}
	
	$(document).ready(function(){
		ResetSendAnAdvisorForm();
	});
	
	$('input').focus(function () {
		$(this).closest(".fieldWrapper").removeClass("error");
		$(this).closest(".smGap").find(".err").hide();
	});

	$('#btnSubmitAdvisor').click(function () {
		
		
		if (Name.val() == "") {
			Name.closest(".fieldWrapper").find(".err").text("Please enter your Name");
			Name.closest(".fieldWrapper").addClass("error");
			return false;
		}
		
		
		if (Phone.val() == "") {
			Phone.closest(".fieldWrapper").find(".err").text("Please enter your Mobile Number");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else if(Phone.val().length != 10){
			Phone.closest(".fieldWrapper").find(".err").text("Mobile Number should be 10 digits");
			Phone.closest(".fieldWrapper").addClass("error");
			return false;
		}

		if (Email.val() == "") {
			Email.closest(".fieldWrapper").find(".err").text("Please enter your Email");
			Email.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else {
			if(!ValidateEmail(Email.val()))
			   {
				 Email.closest(".fieldWrapper").addClass("error");
				 Email.closest(".fieldWrapper").find(".err").text("Please enter Correct Email");
				 return false;
			   }
			Email.attr("placeholder", "Email");
		}

		
		if (Pincode.val() == "") {
			Pincode.closest(".fieldWrapper").find(".err").text("Please enter your Pincode");
			Pincode.closest(".fieldWrapper").addClass("error");
			return false;
		}
		else if(jsonData){
			var found = false;

			$.each(jsonData, function (index, item) {
				if (item.Pincode == parseInt(Pincode.val())) {
					found = true;
					return false;
				}
			});
			
			 if (!found) {
				 Pincode.closest(".fieldWrapper").find(".err").text("Entered pincode is not serviceable");
				Pincode.closest(".fieldWrapper").addClass("error");
				return false;
            }
		}
				
		
		if(_source =="")
		{
			_source = "Webpage";
		}
		
		var model = {
			AdvName: Name.val(),
			Email: Email.val(),
			AdvPhone: Phone.val(),
			AdvPincode: Pincode.val(),
			AdvSource: _source,
			AdvUtmCompaign : _campaign,
			AdvUtmContent : _content,
			AdvUtmMedium : _medium,
			AdvKeyword : _keyword,
			AdvCampaign : campaignName?campaignName:"OTP Verified Leads",
			page_url:$("#PageURL").val()
		};
		
		$.ajax({
			type : "POST",
			url:"/umbraco/surface/Advisor/SendOTP",
			data:{ MobileNo : Phone.val(), Source : _source },
			success:function(data){
				if(data.code == 200)
				{					
					$("#spnPhoneNo").text(Phone.val().toString().substr(-2));
					$("#VerifyOTPModal").modal('show');
					console.log(data.message);
				}else{
					console.log(data.message);
				}
			},
			error:function(err){
				console.log(err);
			}
		});
		
		//if(IsVerify)
		//{
		   
		//}
		//else{
			
			//InitializeCountDown();
		//}
	});
	
		function InitializeCountDown(){
			var date= new Date();
			var countDownTime = new Date(date.getTime() + 60000);
			var x = setInterval(function(){
				var now = new Date().getTime();
				var distance = countDownTime - now;
				$("#time").show();
				$("#time").text("");
				
				var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
				var seconds = Math.floor((distance % (1000 * 60)) / 1000);
				
				var _seconds ="";
				if(seconds<10){
					_seconds = "0"+ seconds.toString();
				}else{
					_seconds = seconds.toString();
				}
				
				$("#time").text("0" + minutes.toString() + ":" + _seconds);
				if (distance < 1) {
					clearInterval(x);
					$("#divAfterOneMinute").show();
					$("#time").hide();
				}
			},1000);
		}
		
		$("#btnChangeNumber").on("click",function(){
			$("#VerifyOTPModal").modal('hide');
			Phone.focus();
		});
		
		$("#btnResendOTP").on("click",function(){
			$.ajax({
				type : "POST",
				url:"/umbraco/surface/Advisor/SendOTP",
				data:{ MobileNo : Phone.val(), Source : _source },
				success:function(data){
					if(data.code == 200)
					{					
						console.log(data.message);
					}else{
						console.log(data.message);
					}
				},
				error:function(err){
					console.log(err);
				}
			});
		});
		
		$("#btnVerifyOTP").on("click",function(){
			
			if($("#txtOTP").val() == "")
			{
				$("#errOTP").text("Please enter OTP to verify your Mobile No.");
				return false;
			}
			else if($("#txtOTP").val().length != 6)
			{
				$("#errOTP").text("OTP cannot be more or less than 6 digits.");
				return false;
			}
			else{
				if(_source =="")
				{
					_source = "Webpage";
				}
				
				var model = {
					AdvName: Name.val(),
					Email: Email.val(),
					AdvPhone: Phone.val(),
					AdvPincode: Pincode.val(),
					AdvSource: _source,
					AdvUtmCompaign : _campaign,
					AdvUtmContent : _content,
					AdvUtmMedium : _medium,
					AdvKeyword : _keyword,
					AdvCampaign : campaignName?campaignName:"OTP Verified Leads",
					page_url:$("#PageURL").val(),
					fbclid: $("#fbclid").val(),
					AdvUtmPlacement:$("#AdvUtmPlacement").val()
				};
			
				$.ajax({
					type : "POST",
					url:"/umbraco/surface/Advisor/VerifyOTP",
					data:{ MobileNo : Phone.val(), OTP : parseInt($("#txtOTP").val()) },
					success:function(data){
						if(data.code == 200)
						{		
							$("#errOTP").text('OTP Verified Successfully.');
							IsVerify = true;
							
							var settings = {
								"async": true,
								"url": "/Umbraco/Surface/Advisor/HandleAdvisorLTIPEnquirySubmit",
								"method": "POST",
								contentType: "application/json; charset=utf-8",
								"data": JSON.stringify(model)
							}

							$.ajax(settings).done(function (response) {
								$("#VerifyOTPModal").modal('hide');
								
								if(response.status == 200){
									window.location.href = "https://life.futuregenerali.in/thank-you?result=success";
								}else if (response.status == 400){
									alert("Enquiry already exists in our database. One of our agent will contact you shortly.");
									return false;
								}else{
									alert("Something went wrong. Please contact administrator.");
									return false;
								}
								
							});			
							
							console.log(data.message);
						}else{
							$("#errOTP").text(data.message);
							console.log(data.message);
						}
					},
					error:function(err){
						console.log(err);
					}
				});
			}
		});
		
		
	
	$("#SAdvCheck").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheckTerm").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

	$("#SAdvCheckTerm").change(function(){
		var _result = $(this).prop("checked");
		
		if(_result == false || $("#SAdvCheck").prop("checked") == false)
		{
			$("#btnSubmitAdvisor").attr("disabled","disabled");
		}
		else{
			$("#btnSubmitAdvisor").removeAttr("disabled");
		}
	});

}